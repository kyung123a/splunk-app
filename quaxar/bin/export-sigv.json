{"id": "indicator--1def3779-7898-4ed1-9b71-d97d7ee5d6cc--2", "type": "yara", "name": "BKDR_XZUtil_Binary_CVE_2024_3094_Mar24_1", "description": "Detects injected code used by the backdoored XZ library (xzutil) CVE-2024-3094.", "created": 1711756800000, "modified": 1711799009961, "author": "Florian Roth", "pattern": "rule BKDR_XZUtil_Binary_CVE_2024_3094_Mar24_1 {\n\nmeta:\n      description = \"Detects injected code used by the backdoored XZ library (xzutil) CVE-2024-3094.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.openwall.com/lists/oss-security/2024/03/29/4\"\n      date = \"2024-03-30\"\n      score = 75\n      hash1 = \"319feb5a9cddd81955d915b5632b4a5f8f9080281fb46e2f6d69d53f693c23ae\"\n      hash2 = \"605861f833fc181c7cdcabd5577ddb8989bea332648a8f498b4eef89b8f85ad4\"\n      hash3 = \"8fa641c454c3e0f76de73b7cc3446096b9c8b9d33d406d38b8ac76090b0344fd\"\n      hash4 = \"b418bfd34aa246b2e7b5cb5d263a640e5d080810f767370c4d2c24662a274963\"\n      hash5 = \"cbeef92e67bf41ca9c015557d81f39adaba67ca9fb3574139754999030b83537\"\n   \nstrings:\n      $op1 = { 48 8d 7c 24 08 f3 ab 48 8d 44 24 08 48 89 d1 4c 89 c7 48 89 c2 e8 ?? ?? ?? ?? 89 c2 }\n      $op2 = { 31 c0 49 89 ff b9 16 00 00 00 4d 89 c5 48 8d 7c 24 48 4d 89 ce f3 ab 48 8d 44 24 48 }\n      $op3 = { 4d 8b 6c 24 08 45 8b 3c 24 4c 8b 63 10 89 85 78 f1 ff ff 31 c0 83 bd 78 f1 ff ff 00 f3 ab 79 07 }\n\n      /* function signature from detect.sh provided by Vegard Nossum */\n      $xc1 = { 30 F1 EF A5 54 88 9F 54 C8 9C E5 38 9F B8 1E 70 00 00 08 04 88 3E C2 84 88 95 42 41 84 88 94 C2 41 00 }\n   \ncondition:\n      uint16(0) == 0x457f\n      and all of ($op*)\n      or $xc1\n\n}", "references": [{"url": "https://www.openwall.com/lists/oss-security/2024/03/29/4", "source": "www.openwall.com"}], "qxrlinks": ["https://portal.quaxar.io/knowledgebase/document/report--ba5f59fb-e4c4-4356-afc2-f5e5cb01a87f"]}
{"id": "indicator--1def3779-7898-4ed1-9b71-d97d7ee5d6cc--1", "type": "yara", "name": "BKDR_XZUtil_Script_CVE_2024_3094_Mar24_1", "description": "Detects make file and script contents used by the backdoored XZ library (xzutil) CVE-2024-3094.", "created": 1711756800000, "modified": 1711799009961, "author": "Florian Roth", "pattern": "rule BKDR_XZUtil_Script_CVE_2024_3094_Mar24_1 {\n\nmeta:\n      description = \"Detects make file and script contents used by the backdoored XZ library (xzutil) CVE-2024-3094.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.openwall.com/lists/oss-security/2024/03/29/4\"\n      date = \"2024-03-30\"\n      score = 80\n   \nstrings:\n      $x1 = \"/bad-3-corrupt_lzma2.xz | tr \" ascii\n      $x2 = \"/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|\" ascii\n      $x3 = \"eval $zrKcKQ\" ascii\n   \ncondition:\n      1 of them\n\n}", "references": [{"url": "https://www.openwall.com/lists/oss-security/2024/03/29/4", "source": "www.openwall.com"}], "qxrlinks": ["https://portal.quaxar.io/knowledgebase/document/report--ba5f59fb-e4c4-4356-afc2-f5e5cb01a87f"]}
